$('.privacy-notice-container').html("<%= j render './privacy_notices/partials/form', privacy_notice: @privacy_notice %>")

// Handle buttons
var nextQuestion = $('.next-question'),
    previousQuestion = $('.previous-question'),
    currentQuestion = $('.current-qst'),
    radioButton = $("input[type=radio]"),
    count = 1;

function HandleQuestions(previousQuestion, count, radioButton){
  // Next question
  radioButton.each(function(){
    var idVal = $(this).attr("id");

    $(this).click(function(){
      if($(this).prop("checked") ===  true) {
        count += 1;
        let current = currentQuestion.hasClass(`question-${count}`);

        if(current && idVal != "3" && idVal != "10") {
          setTimeout(function(){
            $(`form .question-${count}`).fadeIn(200, function(){$(this).removeClass('hidden')});
          }, 300);
          setTimeout(function(){
            $(`form .question-${count - 1}`).fadeOut(200, function(){$(this).addClass('hidden')});
          }, 300);
        }
        else if(current && idVal == "3"){
          count = 5;
          setTimeout(function(){
            $(`form .question-${count}`).fadeIn(200, function(){$(this).removeClass('hidden')});
          }, 300);
          setTimeout(function(){
            $(`form .question-${count - 3}`).fadeOut(200, function(){$(this).addClass('hidden')});
          }, 300);
        }
        else if(current && idVal == "10") {
          count = 7;
          setTimeout(function(){
            $(`form .question-${count}`).fadeIn(200, function(){$(this).removeClass('hidden')});
          }, 300);
          setTimeout(function(){
            $(`form .question-${count - 2}`).fadeOut(200, function(){$(this).addClass('hidden')});
          }, 300);
        }
      }
      if(count > 1){
        setTimeout(function(){
          previousQuestion.removeClass('hidden');
        }, 400);
      }
    });
  });

  // Previous question
  previousQuestion.click(function() {
    count -= 1;
    let current = currentQuestion.hasClass(`question-${count}`);

    if(current) {
      setTimeout(function(){
        $(`form .question-${count}`).fadeIn(200, function(){$(this).removeClass('hidden')});
      }, 300);
      setTimeout(function(){
        $(`form .question-${count + 1}`).fadeOut(200, function(){$(this).removeClass('hidden')});
      }, 300);
    }
    if(count <= 1){
      setTimeout(function(){
        previousQuestion.addClass('hidden');
      }, 400);
    }
  });
}
HandleQuestions(previousQuestion, count, radioButton);

// Prevent enter key submit
$('form').on('keypress', e => {
  if (e.keyCode == 13) {
      return false;
  }
});

// Handle questions conditions
function HandleQuestionsConditions(){
  $("input[type='radio']").each(function(index, element){
    var idVal = $(this).attr("id");
    $(this).click(function(){
      if($(this).prop("checked") ===  true){
        if(idVal == "4"){
          console.log($("label[for='"+idVal+"']").text())
        } else {
          console.log(`Vous avez sélectionné ${$("label[for='"+idVal+"']").text()}`)
        }
      }
    })
  })
}
HandleQuestionsConditions();

// $("input[type='radio']:checked").each(function() {
//   var idVal = $(this).attr("id");
//   alert($("label[for='"+idVal+"']").text());
// });


